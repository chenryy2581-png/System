<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>é»è²¨ç³»çµ± (Firebase ç‰ˆ)</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#007bff">
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h2 { text-align: center; }
    h3.displayBox { text-align: center; font-size: 22px; color: #007bff; margin: 8px 0; }
    label { display: block; margin: 10px 0 6px; }
    select, input, button {
      width: 100%; padding: 10px; font-size: 16px; margin-bottom: 14px;
      border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box;
    }
    button { cursor: pointer; }
    .btn-primary { background: #007bff; color: #fff; border: none; }
    .btn-danger  { background: #dc3545; color: #fff; border: none; }
    .btn-toggle  { background: #28a745; color: #fff; border: none; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background: #f0f0f0; }
  </style>
</head>
<body>
  <h2>ğŸ“¦ é»è²¨ç³»çµ± (Firebase)</h2>

  <h3 class="displayBox">ğŸšš ç•¶å‰å¸æ©Ÿï¼š<span id="driverDisplay">å°šæœªè¨­å®š</span></h3>
  <h3 class="displayBox">ğŸŸ ç•¶å‰é­šç¨®ï¼š<span id="fishDisplay">å°šæœªè¨­å®š</span></h3>

  <form id="form">
    <label>ğŸšš å¸æ©Ÿ</label>
    <select id="currentDriver">
      <option value="">è«‹é¸æ“‡</option>
      <option>è˜‡å¾·æ‘</option><option>è˜‡æ©ç”°</option>
      <option>æè‚²éŠ˜</option><option>æŸ¯å˜‰é›„</option>
      <option>å¤–è»Š1</option><option>å¤–è»Š2</option><option>å¤–è»Š3</option>
    </select>

    <label>ğŸŸ é­šç¨®</label>
    <select id="currentFish">
      <option value="">è«‹é¸æ“‡</option>
      <option>é‡‘ç›®</option><option>åŠ å·</option><option>ä¸ƒæ˜Ÿ</option>
      <option>ç´…å°¼</option><option>é¾è™</option>
    </select>

    <label>ğŸ“ æ“šé»</label>
    <select id="location">
      <option value="">è«‹é¸æ“‡</option>
      <option>å°åŒ—</option><option>åŸºéš†</option><option>ä¸‰é‡</option><option>æ¡ƒåœ’</option>
      <option>ä¸­å£¢o</option><option>ä¸­å£¢x</option>
    </select>

    <label>ğŸªµ æ£§æ¿ç·¨è™Ÿ</label>
    <input type="number" id="pallet" placeholder="ä¾‹å¦‚ï¼š1" inputmode="numeric">

    <label>âš–ï¸ è¦æ ¼ (å°¾/ç®±)</label>
    <input type="number" id="spec" placeholder="ä¾‹å¦‚ï¼š6" inputmode="numeric">

    <label>ğŸ“¦ ç®±æ•¸</label>
    <input type="number" id="box" placeholder="è¼¸å…¥ç®±æ•¸" inputmode="numeric">

    <button type="submit" class="btn-primary">é€å‡º</button>
  </form>

  <h3>ğŸ“‹ å·²é€å‡ºçš„è³‡æ–™</h3>
  <ul id="dataList"></ul>

  <!-- âœ… Firebase é€£æ¥ -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    // ğŸ”‘ Firebase è¨­å®š
    const firebaseConfig = {
      apiKey: "AIzaSyDyzfiGBBfkIYUp_xKykdncocJJwLTnqMs",
      authDomain: "cargosystem-56b91.firebaseapp.com",
      projectId: "cargosystem-56b91",
      storageBucket: "cargosystem-56b91.firebasestorage.app",
      messagingSenderId: "150281096087",
      appId: "1:150281096087:web:96b16f96f6f5887f2692d2",
      measurementId: "G-TLMZFMZW4K"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const form = document.getElementById("form");
    const dataList = document.getElementById("dataList");

    // ğŸ“¤ è¡¨å–®é€å‡º â†’ å¯«å…¥ Firestore
    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const data = {
        driver: document.getElementById("currentDriver").value,
        fish: document.getElementById("currentFish").value,
        location: document.getElementById("location").value,
        pallet: document.getElementById("pallet").value,
        spec: document.getElementById("spec").value,
        box: document.getElementById("box").value,
        createdAt: new Date()
      };

      await addDoc(collection(db, "cargoData"), data);
      alert("âœ… å·²åŒæ­¥åˆ° Firebaseï¼");

      loadData(); // é€å‡ºå¾Œé‡æ–°è¼‰å…¥
      form.reset();
    });

    // ğŸ“¥ è®€å– Firestore
    async function loadData() {
      dataList.innerHTML = "";
      const querySnapshot = await getDocs(collection(db, "cargoData"));
      querySnapshot.forEach((doc) => {
        const d = doc.data();
        const li = document.createElement("li");
        li.textContent = `${d.driver} | ${d.fish} | ${d.location} | è¦æ ¼:${d.spec} | ç®±:${d.box}`;
        dataList.appendChild(li);
      });
    }

    loadData(); // é é¢è¼‰å…¥æ™‚è®€å–
  </script>
</body>
</html>
